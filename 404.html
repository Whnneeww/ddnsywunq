<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç„¡é™ã®ä¸–ç•Œç”Ÿæˆãƒãƒƒãƒ—</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            font-family: Arial, sans-serif;
        }
        #map {
            position: absolute;
            width: 100vw;
            height: 100vh;
            background-color: #e0f7fa;
            touch-action: none; /* ã‚¿ãƒƒãƒã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç„¡åŠ¹ã«ã™ã‚‹ */
        }
        .world {
            position: absolute;
            white-space: nowrap;
            font-size: 2rem; /* è¦ç´ ã®ã‚µã‚¤ã‚ºã‚’å¤§ãã */
        }
    </style>
</head>
<body>
    <div id="map"></div>

    <script>
        const elements = ['ğŸŒ²æ£®', 'ğŸ”ï¸å±±', 'ğŸŒŠå·', 'ğŸ–ï¸ãƒ“ãƒ¼ãƒ', 'ğŸ¡æ‘', 'ğŸ™ï¸ç”º', 'ğŸœï¸ç ‚æ¼ ', 'ğŸŒŒæ´çªŸ'];
        let worldSize = 100;
        let worldMap = {};

        // ä¸–ç•Œã‚’ç”Ÿæˆã™ã‚‹é–¢æ•°
        function generateWorld() {
            let world = [];
            for (let i = 0; i < worldSize; i++) {
                const randomElement = elements[Math.floor(Math.random() * elements.length)];
                const position = {
                    left: Math.floor(Math.random() * window.innerWidth),
                    top: Math.floor(Math.random() * window.innerHeight)
                };
                world.push({ element: randomElement, position });
            }
            return world;
        }

        // ä¸–ç•Œã‚’è¡¨ç¤ºã™ã‚‹é–¢æ•°
        function displayWorld(world) {
            const mapDiv = document.getElementById('map');
            mapDiv.innerHTML = ''; // åˆæœŸåŒ–
            world.forEach(item => {
                const div = document.createElement('div');
                div.classList.add('world');
                div.style.left = `${item.position.left}px`;
                div.style.top = `${item.position.top}px`;
                div.textContent = item.element;
                mapDiv.appendChild(div);
            });
        }

        let scale = 1;
        let translateX = 0;
        let translateY = 0;
        const mapDiv = document.getElementById('map');
        let initialDistance = null;
        let lastTouchX = 0;
        let lastTouchY = 0;

        const touchStartHandler = (event) => {
            if (event.touches.length === 2) {
                // ãƒ”ãƒ³ãƒé–‹å§‹ã®è·é›¢ã‚’è¨ˆæ¸¬
                initialDistance = Math.hypot(
                    event.touches[0].clientX - event.touches[1].clientX,
                    event.touches[0].clientY - event.touches[1].clientY
                );
            } else if (event.touches.length === 1) {
                lastTouchX = event.touches[0].clientX;
                lastTouchY = event.touches[0].clientY;
            }
        };
        
        const touchMoveHandler = (event) => {
            event.preventDefault(); // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’é˜²ã
            if (event.touches.length === 1) {
                // ã‚¹ãƒ¯ã‚¤ãƒ—ç§»å‹•
                const currentX = event.touches[0].clientX;
                const currentY = event.touches[0].clientY;
                translateX += currentX - lastTouchX;
                translateY += currentY - lastTouchY;
                lastTouchX = currentX;
                lastTouchY = currentY;
            } else if (event.touches.length === 2) {
                const newDistance = Math.hypot(
                    event.touches[0].clientX - event.touches[1].clientX,
                    event.touches[0].clientY - event.touches[1].clientY
                );
                scale *= newDistance / initialDistance; // ã‚ºãƒ¼ãƒ ã‚¹ã‚±ãƒ¼ãƒ«ã‚’æ›´æ–°
                initialDistance = newDistance; // ç¾åœ¨ã®è·é›¢ã‚’åˆæœŸè·é›¢ã«æ›´æ–°
            }
            applyTransform();
        };

        const applyTransform = () => {
            mapDiv.style.transform = `translate(${translateX}px, ${translateY}px) scale(${scale})`;
            // ã‚ºãƒ¼ãƒ ã‚¢ã‚¦ãƒˆã®éš›ã«å…¨ä½“ã‚’è¦‹æ¸¡ã›ã‚‹ã‚ˆã†ã«èª¿æ•´
            const adjustedTranslateX = translateX / scale;
            const adjustedTranslateY = translateY / scale;
            const width = window.innerWidth * scale;
            const height = window.innerHeight * scale;

            // ã“ã“ã§ç™½ã„éƒ¨åˆ†ãŒè¦‹ãˆãªã„ã‚ˆã†ã«ã€è¡¨ç¤ºç¯„å›²ã‚’èª¿æ•´
            if (adjustedTranslateX < 0) translateX = 0;
            if (adjustedTranslateY < 0) translateY = 0;
            if (adjustedTranslateX + width > mapDiv.offsetWidth) {
                translateX = mapDiv.offsetWidth - width;
            }
            if (adjustedTranslateY + height > mapDiv.offsetHeight) {
                translateY = mapDiv.offsetHeight - height;
            }
        }

        // ãƒšãƒ¼ã‚¸ãŒèª­ã¿è¾¼ã¾ã‚ŒãŸå¾Œã«ä¸–ç•Œã‚’è¡¨ç¤º
        window.onload = function() {
            const newWorld = generateWorld();
            displayWorld(newWorld);
            mapDiv.addEventListener('touchstart', touchStartHandler);
            mapDiv.addEventListener('touchmove', touchMoveHandler);
        };
    </script>
</body>
</html>
